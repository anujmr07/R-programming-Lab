---
title: "Conditional probability"
output:
  word_document: default
  pdf_document: default
  html_document:
    df_print: paged
editor_options:
  chunk_output_type: inline
---

#### Execute the following cells to load the libraries
```{r}
library(ggplot2)
library(dplyr)
```


#### Load the bats data to a dataframe where the columns correspond to whether a gene is expressed or not expressed in the bats and whether the Ebola virus is present or absent in the bats
```{r}
dfBat = read.csv('Data/bats.csv', header = TRUE, row.names = 1, stringsAsFactors = TRUE)
# dfBat = read.csv('Data/bats.csv', header = TRUE, row.names = 1)
# False = 0, True = 1
head(dfBat)
```

##### Get the genes that are expressed for the 1st bat by using two approaches: (1) logical indexing for the columns in base R (2) the dplyr library
Base R- meaning standard functionality build in R
```{r}

```

#### Calculate the probability that a random bat carries the Ebola virus using two approaches: (1) base R (2) the dplyr library.
```{r}

```

#### Calculate the probability that gene-1 through gene-5 is expressed in a random bat.
```{r}
# dfBat %>% summarise(mean(Gene.1 == T))
# dfBat %>% summarise(mean(Gene.2 == T))
# dfBat %>% summarise(mean(Gene.3 == T))
# dfBat %>% summarise(mean(Gene.4 == T))
# dfBat %>% summarise(mean(Gene.5 == T))

# or

dfBat %>% summarise(across(,mean))
```

#### Is the presence of Ebola virus dependent on the expression of any of the genes 1 through 5? Answer this by noting that if P(Gene-j expressed | Ebola ) = P(Gene-j expressed) approximately based on the data, then the j-th gene's expression is most likely independent of the bat carrying the Ebola virus and vice versa. Note that P(Gene-j expressed) is calculated in the previous question.
```{r}
# Subset the dataframe to those bats that carry the Ebola virus


# Conditional probability that gene-1 through gene-5 is expressed given that the bat carries the Ebola virus

```

#### Suppose a bat has one of the genes identified in the previous question expressed. What is the probability that it carries the Ebola virus? From you answers, conclude which gene's expression is most indicative of a random bat carrying the Ebola virus.
```{r}

```

#### Load the 'emergency.csv' file to a dataframe and answer the following questions:
1. What is the probability that the next incoming patient is in (a) good, (b) fair, and (c) serious condition?
2. What is the probability that the next incoming patient is (a) insured and (b) not insured?
3. What is the probability that the next incoming patient is "serious and insured"?
4. Given that the next incoming patient is known to be serious, what is the probability that they are insured?
5. Given that the next incoming patient is known to be insured, what is the probability that they are serious?
6. Given that the next incoming patient is known to be not insured, what is the probability that they are in a good or fair condition?

```{r}
dfPatient = read.csv('Data/emergency.csv', header = TRUE, row.names = 1)
head(dfPatient)


```

Operations on them
```{r}
# using Base R
mean(dfPatient[,'Condition']=='good')
```

###
1. What is the probability that the next incoming patient is in (a) good, (b) fair, and (c) serious condition?
2. What is the probability that the next incoming patient is (a) insured and (b) not insured?
```{r}
# using Base R
# dfPatient %>% summarise(mean(Condition == 'good'))  ## dyplier we can put the column name in string
# dfPatient %>% summarise(mean(Condition == 'fair'))
# dfPatient %>% summarise(mean(Condition == 'serious'))
# dfPatient %>% summarise(mean(Insurance == 'insured'))
# dfPatient %>% summarise(mean(Insurance == 'not insured'))


# using deplyr
dfPatient %>% summarise(Good_fraction = mean(Condition == 'good'))
dfPatient %>% summarise(fair_fraction = mean(Condition == 'fair'))
dfPatient %>% summarise(serious_fraction = mean(Condition == 'serious'))
dfPatient %>% summarise(insured_fraction = mean(Insurance == 'insured'))
dfPatient %>% summarise(not_insured_fraction = mean(Insurance == 'not insured'))

# <!-- used for finding the Type of data structure of the given value -->

str(dfPatient %>% summarise(not_insured_fraction = mean(Insurance == 'not insured'))) #tells the data structure of that cell
```

###
3. What is the probability that the next incoming patient is "serious and insured"?

```{r}
# using base R
E1 = (dfPatient[ ,'Condition']=='serious')
E2 = (dfPatient[ ,'Insurance']=='insured')
mean(E1 & E2)

```
Using Dplyr doing the same as above with a variable name

```{r}

# using dplyr
dfPatient %>% summarise(Serious_and_insured = mean((Condition == 'serious') & (Insurance == 'insured')))
```
###
4. Given that the next incoming patient is known to be serious, what is the probability that they are insured?

In base R is 
```{r}
dfpatientSerious = dfPatient %>% filter(Condition== 'serious')
mean(dfpatientSerious[,'Insurance'] == 'insured')
```

In Dplyr
```{r}
dfPatient %>% filter(Condition == 'serious') %>% summarise(Insured_given_serious = mean(Insurance == 'insured'))
```

###
5. Given that the next incoming patient is known to be insured, what is the probability that they are serious?
6. Given that the next incoming patient is known to be not insured, what is the probability that they are in a good or fair condition?
```{r}
dfPatient %>% filter(Insurance == "insured") %>% summarise(Serious_given_Insured = mean(Condition == 'serious'))

```

6th  wrote in complement
```{r}
1 - dfPatient %>% filter(Insurance != 'insured') %>% summarise(Serious_given_notinsured = mean(Condition == 'serious'))
```
```{r}
dfPatient %>% filter(Insurance != 'insured') %>% summarise(Serious_given_notinsured = mean(Condition == 'good' | Condition == 'fair'))
```
```{r}
dfPatientnotInsured = dfPatient %>% filter(Insurance == 'not insured')
mean(dfPatientnotInsured[,'Condition']=='good' | dfPatientnotInsured[,'Condition']=='fair')
```


```{r}
```


